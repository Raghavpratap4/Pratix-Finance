<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>GST Calculator</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/html2canvas"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background: linear-gradient(to right, #e3f2fd, #ffffff);
      margin: 0;
      padding: 0;
      text-align: center;
    }
    .header {
      margin-top: 10px;
    }
    header {
      background: #1976d2;
      color: white;
      padding: 1rem;
      font-size: 1.5rem;
    }
    .container {
      max-width: 600px;
      margin: 2rem auto;
      background: white;
      padding: 2rem;
      border-radius: 12px;
      box-shadow: 0 0 20px rgba(0,0,0,0.1);
    }
    label {
      display: block;
      margin: 1rem 0 0.5rem;
      font-weight: bold;
      text-align: left;
    }
    input, select, button {
      width: 100%;
      padding: 0.7rem;
      margin-bottom: 1rem;
      font-size: 1rem;
      border-radius: 8px;
      border: 1px solid #ccc;
    }
    button {
      background: #1976d2;
      color: white;
      border: none;
      cursor: pointer;
      transition: background 0.3s;
    }
    button:hover {
      background: #1565c0;
    }
    .btn-group {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
    }
    #resultSection {
      margin-top: 2rem;
      padding: 1rem;
      background: #f1f8e9;
      border-radius: 10px;
      text-align: left;
    }
    canvas {
      max-width: 100%;
      margin-top: 20px;
    }
    #previewMode {
      display: none;
      padding: 1rem;
      margin-top: 1rem;
      background: #fff;
      border-radius: 12px;
      max-width: 700px;
      margin-left: auto;
      margin-right: auto;
    }
    .download-btns {
      display: flex;
      gap: 10px;
      justify-content: center;
      margin-top: 1rem;
      flex-wrap: wrap;
    }
  </style>
</head>
<body>
<div class="header" id="mainHeader">
  <img src="logo.png" alt="Logo" style="display:block; margin:10px auto; max-width:150px;"/>
  <h1 id="gstcalculatortitle">üí∞ GST CALCULATOR</h1>
</div>
<div class="container" id="mainContainer">
  <label for="amount">Enter Amount (‚Çπ):</label>
  <input type="number" id="amount" placeholder="0" />
  <label for="rate">Select GST Rate (%):</label>
  <select id="rate">
    <option value="5">5%</option>
    <option value="12">12%</option>
    <option value="18" selected>18%</option>
    <option value="28">28%</option>
  </select>
  <div class="btn-group">
    <button id="resetBtn">üîÅ Reset</button>
    <button id="calculateBtn">üìä Calculate</button>
    <button id="previewBtn">üëÅÔ∏è Preview</button>
  </div>
  <div id="resultSection">
    <h3>GST Calculation Result</h3>
    <p id="cgst"></p>
    <p id="sgst"></p>
    <p id="totalGst"></p>
    <p id="finalAmount"></p>
    <canvas id="gstPieChart"></canvas>
    <canvas id="gstBarChart"></canvas>
  </div>
</div>
<div id="previewMode">
  <div id="previewContent"></div>
  <div class="download-btns">
    <button onclick="downloadImage()">üì∏ Image</button>
    <button onclick="downloadPDF()">üìÑ PDF</button>
  </div>
</div>
<script>
  let pieChart, barChart;
  document.getElementById("calculateBtn").onclick = () => {
    const amount = parseFloat(document.getElementById("amount").value);
    const rate = parseFloat(document.getElementById("rate").value);
    if (isNaN(amount)) return alert("Please enter a valid amount!");
    const gstAmount = (amount * rate) / 100;
    const cgst = gstAmount / 2;
    const sgst = gstAmount / 2;
    const total = amount + gstAmount;
    document.getElementById("cgst").textContent = `CGST: ‚Çπ${cgst.toFixed(2)}`;
    document.getElementById("sgst").textContent = `SGST: ‚Çπ${sgst.toFixed(2)}`;
    document.getElementById("totalGst").textContent = `Total GST: ‚Çπ${gstAmount.toFixed(2)}`;
    document.getElementById("finalAmount").textContent = `Final Amount: ‚Çπ${total.toFixed(2)}`;
    const ctx1 = document.getElementById("gstPieChart").getContext("2d");
    const ctx2 = document.getElementById("gstBarChart").getContext("2d");
    if (pieChart) pieChart.destroy();
    if (barChart) barChart.destroy();
    pieChart = new Chart(ctx1, {
      type: 'pie',
      data: {
        labels: ['Base', 'GST'],
        datasets: [{
          data: [amount, gstAmount],
          backgroundColor: ['#42a5f5', '#66bb6a']
        }]
      }
    });
    barChart = new Chart(ctx2, {
      type: 'bar',
      data: {
        labels: ['CGST', 'SGST', 'Final Amount'],
        datasets: [{
          label: 'Amount in ‚Çπ',
          data: [cgst, sgst, total],
          backgroundColor: ['#ff7043', '#ab47bc', '#29b6f6']
        }]
      }
    });
  };
  document.getElementById("resetBtn").onclick = () => {
    document.getElementById("amount").value = "";
    document.getElementById("rate").value = "18";
    document.getElementById("cgst").textContent = "";
    document.getElementById("sgst").textContent = "";
    document.getElementById("totalGst").textContent = "";
    document.getElementById("finalAmount").textContent = "";
    if (pieChart) pieChart.destroy();
    if (barChart) barChart.destroy();
  };
  document.getElementById("previewBtn").onclick = () => {
    const content = document.getElementById("previewContent");
    const logo = document.querySelector(".header").innerHTML;
    const amount = document.getElementById("amount").value;
    const rate = document.getElementById("rate").value;
    content.innerHTML = `
      <div class="header">${logo}</div>
      <h2>üßæ Input Details</h2>
      <p><strong>Amount:</strong> ‚Çπ${amount}</p>
      <p><strong>GST Rate:</strong> ${rate}%</p>
      <h2>üìä Result</h2>
      <p>${document.getElementById("cgst").textContent}</p>
      <p>${document.getElementById("sgst").textContent}</p>
      <p>${document.getElementById("totalGst").textContent}</p>
      <p>${document.getElementById("finalAmount").textContent}</p>
    `;
    document.getElementById("previewMode").style.display = "block";
    const pieClone = document.getElementById("gstPieChart").cloneNode(true);
    const barClone = document.getElementById("gstBarChart").cloneNode(true);
    content.appendChild(pieClone);
    content.appendChild(barClone);
    const ctx1 = pieClone.getContext("2d");
    const ctx2 = barClone.getContext("2d");
    new Chart(ctx1, { type: 'pie', data: pieChart.data, options: pieChart.options });
    new Chart(ctx2, { type: 'bar', data: barChart.data, options: barChart.options });
  };
  window.downloadImage = () => {
    html2canvas(document.getElementById("previewMode")).then(canvas => {
      const link = document.createElement("a");
      link.download = "gst_preview.png";
      link.href = canvas.toDataURL();
      link.click();
    });
  };
  window.downloadPDF = () => {
    html2canvas(document.getElementById("previewMode")).then(canvas => {
      const { jsPDF } = window.jspdf;
      const pdf = new jsPDF();
      const img = canvas.toDataURL("image/png");
      pdf.addImage(img, "PNG", 10, 10, 190, 0);
      pdf.save("gst_preview.pdf");
    });
  };
</script>
</body>
</html>
