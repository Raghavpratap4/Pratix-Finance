<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>EMI Calculator - Pratix Finance</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <style>
    body {
      margin: 0;
      font-family: 'Segoe UI', sans-serif;
      background: linear-gradient(to bottom right, #e0f7fa, #ffffff);
      color: #333;
    }
    header {
      text-align: center;
      padding: 20px;
    }
    header img {
      height: 60px;
    }
    .container {
      max-width: 700px;
      margin: auto;
      padding: 20px;
      background: #fff;
      border-radius: 12px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    .input-group {
      margin: 15px 0;
    }
    .input-group label {
      display: block;
      font-weight: bold;
      margin-bottom: 5px;
    }
    .input-group input, .input-group select {
      width: 100%;
      padding: 10px;
      border-radius: 8px;
      border: 1px solid #ccc;
      font-size: 16px;
    }
    .buttons {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-top: 20px;
    }
    .buttons button {
      flex: 1;
      padding: 10px;
      border: none;
      border-radius: 8px;
      font-size: 16px;
      cursor: pointer;
    }
    .buttons .reset { background: #ffcdd2; }
    .buttons .calculate { background: #aed581; }
    .buttons .preview { background: #81d4fa; }
    .preview-area { display: none; padding: 20px; border-radius: 12px; background: #f5f5f5; margin-top: 20px; }
    .results, .charts, .description, .footer { margin-top: 30px; }
    canvas { width: 100% !important; height: auto !important; }
    .footer { text-align: center; font-size: 14px; color: #666; }
    .footer a { color: #0077cc; text-decoration: none; }
    .download-share {
      display: flex;
      justify-content: center;
      gap: 10px;
      margin-top: 20px;
    }
    .download-share button {
      padding: 8px 12px;
      border-radius: 8px;
      background: #cfd8dc;
      border: none;
      cursor: pointer;
    }
    #languageSelector {
      width: 100%;
      padding: 10px;
      margin-bottom: 20px;
      border-radius: 8px;
      font-size: 16px;
    }
  </style>
</head>
<body>
  <header>
    <img src="logo.png" alt="Pratix Finance Logo">
    <h1 id="title">EMI Calculator</h1>
  </header>
  <div class="container" id="mainContainer">
    <select id="languageSelector" onchange="changeLanguage()">
      <option value="en">English</option>
      <option value="hi">हिन्दी</option>
      <option value="bn">বাংলা</option>
      <option value="fr">Français</option>
      <option value="ru">Русский</option>
      <option value="es">Español</option>
      <option value="ja">日本語</option>
      <option value="ko">한국어</option>
    </select>

    <div class="input-group">
      <label for="loanAmount" id="labelLoanAmount">Loan Amount</label>
      <input type="number" id="loanAmount" placeholder="Enter loan amount" />
    </div>
    <div class="input-group">
      <label for="interestRate" id="labelInterestRate">Interest Rate (% per annum)</label>
      <input type="number" id="interestRate" placeholder="Enter interest rate" step="0.01" />
    </div>
    <div class="input-group">
      <label for="loanTenure" id="labelLoanTenure">Loan Tenure</label>
      <input type="number" id="loanTenure" placeholder="Enter tenure" />
      <select id="tenureType">
        <option value="years">Years</option>
        <option value="months">Months</option>
      </select>
    </div>
    <div class="buttons">
      <button class="reset" onclick="resetForm()" id="btnReset">Reset</button>
      <button class="calculate" onclick="calculateEMI()" id="btnCalculate">Calculate</button>
      <button class="preview" onclick="showPreview()" id="btnPreview">Preview</button>
    </div>
    <div class="results" id="results"></div>
    <div class="charts">
      <canvas id="pieChart"></canvas>
      <canvas id="barChart"></canvas>
    </div>
    <div class="preview-area" id="previewArea"></div>
    <div class="download-share" id="downloadShare" style="display:none">
      <button onclick="downloadImage()">Download Image</button>
      <button onclick="downloadPDF()">Download PDF</button>
      <button onclick="shareResult()">Share</button>
    </div>
    <div class="description" id="descriptionText">
      <p>This EMI Calculator helps you determine your monthly loan repayment based on the loan amount, interest rate, and tenure. It supports reducing balance EMI calculations and provides a breakdown of total interest and principal.</p>
    </div>
    <div class="footer">
      <p>Contact us: <a href="mailto:pratixfinance4@gmail.com">pratixfinance4@gmail.com</a></p>
    </div>
  </div>
<script>
const translations = {
  en: {title: "EMI Calculator", loanAmount: "Loan Amount", interestRate: "Interest Rate (% per annum)", loanTenure: "Loan Tenure", reset: "Reset", calculate: "Calculate", preview: "Preview", description: "This EMI Calculator helps you determine your monthly loan repayment."},
  hi: {title: "ईएमआई कैलकुलेटर", loanAmount: "ऋण राशि", interestRate: "ब्याज दर (% प्रति वर्ष)", loanTenure: "ऋण अवधि", reset: "रीसेट", calculate: "गणना करें", preview: "पूर्वावलोकन", description: "यह ईएमआई कैलकुलेटर आपकी मासिक किस्त की गणना करता है।"},
  bn: {title: "ইএমআই ক্যালকুলেটর", loanAmount: "ঋণের পরিমাণ", interestRate: "সুদের হার (% প্রতি বছর)", loanTenure: "ঋণের মেয়াদ", reset: "রিসেট", calculate: "হিসাব করুন", preview: "প্রিভিউ", description: "এই ইএমআই ক্যালকুলেটর আপনাকে মাসিক কিস্তি নির্ধারণে সহায়তা করে।"},
  fr: {title: "Calculateur EMI", loanAmount: "Montant du prêt", interestRate: "Taux d'intérêt (% par an)", loanTenure: "Durée du prêt", reset: "Réinitialiser", calculate: "Calculer", preview: "Aperçu", description: "Ce calculateur EMI vous aide à déterminer vos remboursements mensuels."},
  ru: {title: "Калькулятор EMI", loanAmount: "Сумма кредита", interestRate: "Процентная ставка (% в год)", loanTenure: "Срок кредита", reset: "Сброс", calculate: "Рассчитать", preview: "Предпросмотр", description: "Этот калькулятор EMI поможет рассчитать ежемесячный платеж."},
  es: {title: "Calculadora EMI", loanAmount: "Monto del préstamo", interestRate: "Tasa de interés (% anual)", loanTenure: "Plazo del préstamo", reset: "Reiniciar", calculate: "Calcular", preview: "Vista previa", description: "Esta calculadora EMI ayuda a determinar su pago mensual."},
  ja: {title: "EMI計算機", loanAmount: "ローン金額", interestRate: "金利（年率％）", loanTenure: "ローン期間", reset: "リセット", calculate: "計算", preview: "プレビュー", description: "このEMI計算機は月々の返済額を計算します。"},
  ko: {title: "EMI 계산기", loanAmount: "대출 금액", interestRate: "이자율 (% 연간)", loanTenure: "대출 기간", reset: "재설정", calculate: "계산", preview: "미리보기", description: "이 EMI 계산기는 월별 상환금을 계산하는 데 도움이 됩니다."}
};

function changeLanguage() {
  const lang = document.getElementById("languageSelector").value;
  const t = translations[lang];
  document.getElementById("title").innerText = t.title;
  document.getElementById("labelLoanAmount").innerText = t.loanAmount;
  document.getElementById("labelInterestRate").innerText = t.interestRate;
  document.getElementById("labelLoanTenure").innerText = t.loanTenure;
  document.getElementById("btnReset").innerText = t.reset;
  document.getElementById("btnCalculate").innerText = t.calculate;
  document.getElementById("btnPreview").innerText = t.preview;
  document.getElementById("descriptionText").innerHTML = `<p>${t.description}</p>`;
}

function resetForm() {
  document.getElementById("loanAmount").value = '';
  document.getElementById("interestRate").value = '';
  document.getElementById("loanTenure").value = '';
  document.getElementById("results").innerHTML = '';
  document.getElementById("pieChart").style.display = 'none';
  document.getElementById("barChart").style.display = 'none';
  document.getElementById("previewArea").style.display = 'none';
  document.getElementById("downloadShare").style.display = 'none';
}

function calculateEMI() {
  const principal = parseFloat(document.getElementById("loanAmount").value);
  const annualRate = parseFloat(document.getElementById("interestRate").value);
  let tenure = parseInt(document.getElementById("loanTenure").value);
  const type = document.getElementById("tenureType").value;
  if (type === "years") tenure *= 12;
  const monthlyRate = annualRate / 12 / 100;
  const emi = principal * monthlyRate * Math.pow(1 + monthlyRate, tenure) / (Math.pow(1 + monthlyRate, tenure) - 1);
  const totalPayment = emi * tenure;
  const totalInterest = totalPayment - principal;
  document.getElementById("results").innerHTML = `
    <p><strong>Monthly EMI:</strong> ₹${emi.toFixed(2)}</p>
    <p><strong>Total Interest:</strong> ₹${totalInterest.toFixed(2)}</p>
    <p><strong>Total Payment:</strong> ₹${totalPayment.toFixed(2)}</p>`;

  renderCharts(principal, totalInterest);
}

function renderCharts(principal, interest) {
  const pieCtx = document.getElementById("pieChart").getContext("2d");
  const barCtx = document.getElementById("barChart").getContext("2d");
  if (window.pieChart) window.pieChart.destroy();
  if (window.barChart) window.barChart.destroy();
  window.pieChart = new Chart(pieCtx, {
    type: 'pie',
    data: { labels: ['Principal', 'Interest'], datasets: [{ data: [principal, interest], backgroundColor: ['#4db6ac', '#ffab91'] }] }
  });
  window.barChart = new Chart(barCtx, {
    type: 'bar',
    data: { labels: ['Principal', 'Interest'], datasets: [{ data: [principal, interest], backgroundColor: ['#4db6ac', '#ffab91'] }] }
  });
}

function showPreview() {
  const lang = document.getElementById("languageSelector").value;
  const title = translations[lang].title;
  const loan = document.getElementById("loanAmount").value;
  const rate = document.getElementById("interestRate").value;
  const tenure = document.getElementById("loanTenure").value + ' ' + document.getElementById("tenureType").value;
  const resultHTML = document.getElementById("results").innerHTML;
  document.getElementById("previewArea").innerHTML = `
    <img src='logo.png' style='height:60px'><h2>${title}</h2>
    <p><strong>Loan:</strong> ₹${loan}</p>
    <p><strong>Rate:</strong> ${rate}%</p>
    <p><strong>Tenure:</strong> ${tenure}</p>
    ${resultHTML}
    <canvas id="pieChartPreview"></canvas>
    <canvas id="barChartPreview"></canvas>`;
  document.getElementById("previewArea").style.display = 'block';
  document.getElementById("downloadShare").style.display = 'flex';
  renderPreviewCharts();
}

function renderPreviewCharts() {
  const principal = parseFloat(document.getElementById("loanAmount").value);
  const annualRate = parseFloat(document.getElementById("interestRate").value);
  let tenure = parseInt(document.getElementById("loanTenure").value);
  const type = document.getElementById("tenureType").value;
  if (type === "years") tenure *= 12;
  const monthlyRate = annualRate / 12 / 100;
  const emi = principal * monthlyRate * Math.pow(1 + monthlyRate, tenure) / (Math.pow(1 + monthlyRate, tenure) - 1);
  const totalPayment = emi * tenure;
  const interest = totalPayment - principal;
  const pieCtx = document.getElementById("pieChartPreview").getContext("2d");
  const barCtx = document.getElementById("barChartPreview").getContext("2d");
  new Chart(pieCtx, {
    type: 'pie', data: { labels: ['Principal', 'Interest'], datasets: [{ data: [principal, interest], backgroundColor: ['#4db6ac', '#ffab91'] }] }
  });
  new Chart(barCtx, {
    type: 'bar', data: { labels: ['Principal', 'Interest'], datasets: [{ data: [principal, interest], backgroundColor: ['#4db6ac', '#ffab91'] }] }
  });
}

function downloadImage() {
  html2canvas(document.getElementById("previewArea")).then(canvas => {
    const link = document.createElement("a");
    link.download = "emi-preview.png";
    link.href = canvas.toDataURL();
    link.click();
  });
}

function downloadPDF() {
  const { jsPDF } = window.jspdf;
  html2canvas(document.getElementById("previewArea")).then(canvas => {
    const imgData = canvas.toDataURL("image/png");
    const pdf = new jsPDF();
    const imgProps = pdf.getImageProperties(imgData);
    const pdfWidth = pdf.internal.pageSize.getWidth();
    const pdfHeight = (imgProps.height * pdfWidth) / imgProps.width;
    pdf.addImage(imgData, "PNG", 0, 0, pdfWidth, pdfHeight);
    pdf.save("emi-preview.pdf");
  });
}

function shareResult() {
  if (navigator.share) {
    navigator.share({ title: 'EMI Calculator - Pratix Finance', url: window.location.href });
  } else {
    alert("Sharing not supported on this browser.");
  }
}
</script>
</body>
</html>
