<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="PRATIX FINANCE - Your comprehensive financial calculator suite for EMI, SIP, Tax calculations and more." />
    <meta name="keywords" content="PRATIX FINANCE, EMI calculator, SIP calculator, financial tools, loan calculator, investment calculator" />
    <meta name="author" content="Pratix Finance" />
    <title>PRATIX FINANCE - Financial Calculators & Tools</title>

    <!-- PWA Meta Tags -->
    <meta name="theme-color" content="#31417F">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Pratix Finance">
    <meta name="msapplication-TileColor" content="#31417F">
    <meta name="msapplication-TileImage" content="/favicon.png">

    <!-- PWA Manifest -->
    <link rel="manifest" href="/manifest.json">

    <!-- Icons -->
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    <link rel="icon" type="image/png" sizes="192x192" href="/favicon.png">
    <link rel="apple-touch-icon" href="/logo.png">

    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <link href="style.css" rel="stylesheet" type="text/css" />
</head>
<body>
    <!-- Update Notification -->
    <div id="updateNotification" class="update-notification">
        <div class="update-content">
            <span class="update-icon">üîÑ</span>
            <div class="update-text">
                <div class="update-title">New Update Available</div>
                <div class="update-description">Click to refresh and get the latest features</div>
            </div>
            <button id="updateButton" class="update-btn">Update Now</button>
            <button id="dismissUpdate" class="dismiss-btn" style="opacity: 0.5; pointer-events: none;">√ó</button>
        </div>
    </div>

    <!-- Main Content Wrapper -->
    <div class="main-wrapper">
        <!-- Header -->
        <header class="standard-header">
            <div class="standard-header-content">
                <div class="standard-logo-section">
                    <img src="logo.png" alt="PRATIX FINANCE Logo" class="standard-app-logo">
                    <h1 class="standard-app-title">PRATIX FINANCE</h1>
                </div>
                <div class="standard-nav-buttons">
                    <a href="#download" class="standard-nav-btn" id="downloadApp">
                        <span>üì±</span>
                    </a>
                    <a href="#search" class="standard-nav-btn" onclick="document.getElementById('searchInput').focus()">
                        <span>üîç</span>
                    </a>
                </div>
            </div>
        </header>

        <!-- Hero Section -->
        <section class="hero-section">
            <div class="container">
                <div class="hero-content">
                    <div class="hero-badge">
                        <span class="badge-icon">üèÜ</span>
                        <span>India's #1 Financial Calculator Platform</span>
                    </div>
                    <h1 class="hero-title">Complete Financial Calculator Suite</h1>
                    <p class="hero-subtitle">
                        Professional-grade calculators for EMI, SIP, Tax, FD, and GST calculations. 
                        Make smarter financial decisions with accurate projections and detailed analysis.
                    </p>
                    <div class="hero-stats">
                        <div class="stat-item">
                            <div class="stat-number">50K+</div>
                            <div class="stat-label">Users</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-number">5</div>
                            <div class="stat-label">Calculators</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-number">99.9%</div>
                            <div class="stat-label">Accuracy</div>
                        </div>
                    </div>
                    <div class="hero-actions">
                        <a href="#calculators" class="primary-btn">
                            <span class="btn-icon">üßÆ</span>
                            <span>Start Calculating</span>
                        </a>
                        <div id="downloadSection" class="download-action">
                            <button class="secondary-btn" id="downloadAppHero">
                                <span class="btn-icon">üì±</span>
                                <span>Download App</span>
                            </button>
                            <div class="download-notification" id="downloadNotification">
                                <span class="notification-icon">‚ö°</span>
                                <span>Get offline access & better performance</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Search Section -->
        <section class="search-section" id="search">
            <div class="container">
                <div class="search-container">
                    <div class="search-icon">üîç</div>
                    <input type="text" class="search-bar" placeholder="Search calculators (EMI, SIP, Tax, FD, GST...)" id="searchInput">
                    <div class="search-results" id="searchResults"></div>
                </div>
            </div>
        </section>

        <!-- Calculators Section -->
        <section class="calculators-section" id="calculators">
            <div class="container">
                <div class="section-header">
                    <h2 class="section-title">Financial Calculators & Tools</h2>
                    <p class="section-subtitle">Choose from our comprehensive suite of professional financial calculators</p>
                </div>
                <div class="calculators-grid" id="calculatorsGrid">
                    <!-- EMI Calculator -->
                    <div class="calculator-card featured" data-name="EMI Calculator" data-keywords="emi loan mortgage home car personal finance interest">
                        <div class="card-header">
                            <div class="calculator-icon">üè†</div>
                            <div class="card-badge">Most Popular</div>
                        </div>
                        <div class="card-content">
                            <h3 class="calculator-title">EMI Calculator</h3>
                            <p class="calculator-description">Calculate loan EMIs with detailed amortization schedules, prepayment analysis, and loan comparison tools.</p>
                            <ul class="calculator-features">
                                <li><span class="feature-icon">‚úì</span>Monthly EMI calculation</li>
                                <li><span class="feature-icon">‚úì</span>Amortization table</li>
                                <li><span class="feature-icon">‚úì</span>Prepayment impact</li>
                                <li><span class="feature-icon">‚úì</span>Loan comparison</li>
                            </ul>
                        </div>
                        <div class="card-footer">
                            <a href="emi-calculator.html" class="use-btn">
                                <span>Use Calculator</span>
                                <span class="btn-arrow">‚Üí</span>
                            </a>
                        </div>
                    </div>

                    <!-- SIP Calculator -->
                    <div class="calculator-card" data-name="SIP Calculator" data-keywords="sip mutual fund investment systematic plan returns">
                        <div class="card-header">
                            <div class="calculator-icon">üìà</div>
                        </div>
                        <div class="card-content">
                            <h3 class="calculator-title">SIP Calculator</h3>
                            <p class="calculator-description">Plan systematic investments with future value projections, step-up SIP analysis, and goal-based planning.</p>
                            <ul class="calculator-features">
                                <li><span class="feature-icon">‚úì</span>Future value calculation</li>
                                <li><span class="feature-icon">‚úì</span>Step-up SIP planning</li>
                                <li><span class="feature-icon">‚úì</span>Goal-based investing</li>
                                <li><span class="feature-icon">‚úì</span>Returns comparison</li>
                            </ul>
                        </div>
                        <div class="card-footer">
                            <a href="sip-calculator.html" class="use-btn">
                                <span>Use Calculator</span>
                                <span class="btn-arrow">‚Üí</span>
                            </a>
                        </div>
                    </div>

                    <!-- Tax Calculator -->
                    <div class="calculator-card" data-name="Income Tax Calculator" data-keywords="tax income tax calculator old new regime">
                        <div class="card-header">
                            <div class="calculator-icon">üíº</div>
                        </div>
                        <div class="card-content">
                            <h3 class="calculator-title">Income Tax Calculator</h3>
                            <p class="calculator-description">Calculate tax liability under both regimes with deduction optimization and salary breakdown analysis.</p>
                            <ul class="calculator-features">
                                <li><span class="feature-icon">‚úì</span>Old vs New regime</li>
                                <li><span class="feature-icon">‚úì</span>Deduction planning</li>
                                <li><span class="feature-icon">‚úì</span>Tax saving tips</li>
                                <li><span class="feature-icon">‚úì</span>Salary breakdown</li>
                            </ul>
                        </div>
                        <div class="card-footer">
                            <a href="tax-calculator.html" class="use-btn">
                                <span>Use Calculator</span>
                                <span class="btn-arrow">‚Üí</span>
                            </a>
                        </div>
                    </div>

                    <!-- Fixed Deposit Calculator -->
                    <div class="calculator-card" data-name="Fixed Deposit Calculator" data-keywords="fd fixed deposit bank interest maturity">
                        <div class="card-header">
                            <div class="calculator-icon">üè¶</div>
                        </div>
                        <div class="card-content">
                            <h3 class="calculator-title">FD Calculator</h3>
                            <p class="calculator-description">Calculate fixed deposit returns with compound interest analysis and bank rate comparisons.</p>
                            <ul class="calculator-features">
                                <li><span class="feature-icon">‚úì</span>Maturity amount</li>
                                <li><span class="feature-icon">‚úì</span>Interest comparison</li>
                                <li><span class="feature-icon">‚úì</span>Tax on interest</li>
                                <li><span class="feature-icon">‚úì</span>Quarterly compounding</li>
                            </ul>
                        </div>
                        <div class="card-footer">
                            <a href="fd-calculator.html" class="use-btn">
                                <span>Use Calculator</span>
                                <span class="btn-arrow">‚Üí</span>
                            </a>
                        </div>
                    </div>

                    <!-- GST Calculator -->
                    <div class="calculator-card" data-name="GST Calculator" data-keywords="gst goods services tax business invoice">
                        <div class="card-header">
                            <div class="calculator-icon">üìä</div>
                        </div>
                        <div class="card-content">
                            <h3 class="calculator-title">GST Calculator</h3>
                            <p class="calculator-description">Calculate GST for business transactions with multiple tax rates, HSN codes, and invoice generation.</p>
                            <ul class="calculator-features">
                                <li><span class="feature-icon">‚úì</span>Multiple GST rates</li>
                                <li><span class="feature-icon">‚úì</span>Inclusive/Exclusive</li>
                                <li><span class="feature-icon">‚úì</span>HSN code lookup</li>
                                <li><span class="feature-icon">‚úì</span>Invoice generation</li>
                            </ul>
                        </div>
                        <div class="card-footer">
                            <a href="gst-calculator.html" class="use-btn">
                                <span>Use Calculator</span>
                                <span class="btn-arrow">‚Üí</span>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Features Section -->
        <section class="features-section">
            <div class="container">
                <div class="section-header">
                    <h2 class="section-title">Why Choose PRATIX FINANCE?</h2>
                    <p class="section-subtitle">Professional-grade financial tools trusted by thousands of users</p>
                </div>
                <div class="features-grid">
                    <div class="feature-item">
                        <div class="feature-icon">‚ö°</div>
                        <h3 class="feature-title">Lightning Fast</h3>
                        <p class="feature-description">Get instant calculations with real-time updates, interactive charts, and seamless performance across all devices.</p>
                    </div>
                    <div class="feature-item">
                        <div class="feature-icon">üîí</div>
                        <h3 class="feature-title">100% Secure</h3>
                        <p class="feature-description">Your financial data stays completely private. All calculations happen locally in your browser with no data transmission.</p>
                    </div>
                    <div class="feature-item">
                        <div class="feature-icon">üì±</div>
                        <h3 class="feature-title">Mobile Optimized</h3>
                        <p class="feature-description">Access all calculators on any device with our responsive design and progressive web app capabilities.</p>
                    </div>
                    <div class="feature-item">
                        <div class="feature-icon">üí°</div>
                        <h3 class="feature-title">Smart Insights</h3>
                        <p class="feature-description">Get detailed analysis, visual charts, and intelligent recommendations for better financial planning.</p>
                    </div>
                    <div class="feature-item">
                        <div class="feature-icon">üìä</div>
                        <h3 class="feature-title">Detailed Reports</h3>
                        <p class="feature-description">Generate comprehensive reports with amortization tables, tax breakdowns, and investment projections.</p>
                    </div>
                    <div class="feature-item">
                        <div class="feature-icon">üéØ</div>
                        <h3 class="feature-title">Goal Planning</h3>
                        <p class="feature-description">Set financial goals and get personalized strategies to achieve them with our advanced planning tools.</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Trust Section -->
        <section class="trust-section">
            <div class="container">
                <div class="trust-content">
                    <div class="trust-header">
                        <h2 class="section-title">Trusted by Financial Professionals</h2>
                        <p class="section-subtitle">Join thousands of users making smarter financial decisions</p>
                    </div>
                    <div class="trust-stats">
                        <div class="trust-stat">
                            <div class="trust-number">50,000+</div>
                            <div class="trust-label">Active Users</div>
                        </div>
                        <div class="trust-stat">
                            <div class="trust-number">1M+</div>
                            <div class="trust-label">Calculations Done</div>
                        </div>
                        <div class="trust-stat">
                            <div class="trust-number">99.9%</div>
                            <div class="trust-label">Accuracy Rate</div>
                        </div>
                        <div class="trust-stat">
                            <div class="trust-number">4.9‚òÖ</div>
                            <div class="trust-label">User Rating</div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Enhanced Professional World-Class Footer -->
        <footer class="professional-footer">
            <div class="footer-container">
                <!-- Elite Brand Section -->
                <div class="footer-brand-elite">
                    <div class="brand-header-elite">
                        <img src="logo.png" alt="Pratix Finance" class="footer-logo-elite">
                        <h3 class="brand-name-elite">PRATIX FINANCE</h3>
                    </div>
                    <p class="brand-tagline-elite">India's Most Trusted Financial Calculator Platform</p>
                    <div class="world-no1-badge">
                        <span>üèÜ</span>
                        <span>#1 Financial Calculator Suite</span>
                    </div>
                </div>

                <!-- Awards Section -->
                <div class="awards-section">
                    <div class="award-badge">
                        <span>ü•á</span>
                        <span>Best Financial Tool 2024</span>
                    </div>
                    <div class="award-badge">
                        <span>‚≠ê</span>
                        <span>User's Choice Award</span>
                    </div>
                    <div class="award-badge">
                        <span>üöÄ</span>
                        <span>Innovation Excellence</span>
                    </div>
                </div>

                <div class="footer-links-elite-grid">
                    <div class="footer-section-elite">
                        <h3 class="footer-section-title-elite">
                            <span>üßÆ</span>
                            Calculators
                        </h3>
                        <ul class="footer-links-list-elite">
                            <li><a href="emi-calculator.html" class="footer-link-elite">
                                <span class="footer-link-icon-elite">üè†</span>
                                EMI Calculator
                            </a></li>
                            <li><a href="sip-calculator.html" class="footer-link-elite">
                                <span class="footer-link-icon-elite">üìà</span>
                                SIP Calculator
                            </a></li>
                            <li><a href="fd-calculator.html" class="footer-link-elite">
                                <span class="footer-link-icon-elite">üè¶</span>
                                FD Calculator
                            </a></li>
                            <li><a href="gst-calculator.html" class="footer-link-elite">
                                <span class="footer-link-icon-elite">üìä</span>
                                GST Calculator
                            </a></li>
                            <li><a href="tax-calculator.html" class="footer-link-elite">
                                <span class="footer-link-icon-elite">üìã</span>
                                Tax Calculator
                            </a></li>
                        </ul>
                    </div>

                    <div class="footer-section-elite">
                        <h3 class="footer-section-title-elite">
                            <span>üíº</span>
                            Financial Tools
                        </h3>
                        <ul class="footer-links-list-elite">
                            <li><a href="sip-calculator.html" class="footer-link-elite">
                                <span class="footer-link-icon-elite">üéØ</span>
                                Goal Planning
                            </a></li>
                            <li><a href="emi-calculator.html" class="footer-link-elite">
                                <span class="footer-link-icon-elite">üí∞</span>
                                Loan Planning
                            </a></li>
                            <li><a href="fd-calculator.html" class="footer-link-elite">
                                <span class="footer-link-icon-elite">üìä</span>
                                Investment Planning
                            </a></li>
                            <li><a href="tax-calculator.html" class="footer-link-elite">
                                <span class="footer-link-icon-elite">üßæ</span>
                                Tax Planning
                            </a></li>
                            <li><a href="gst-calculator.html" class="footer-link-elite">
                                <span class="footer-link-icon-elite">üè¢</span>
                                Business Tools
                            </a></li>
                        </ul>
                    </div>

                    <div class="footer-section-elite">
                        <h3 class="footer-section-title-elite">
                            <span>üìö</span>
                            Resources
                        </h3>
                        <ul class="footer-links-list-elite">
                            <li><a href="blog.html" class="footer-link-elite">
                                <span class="footer-link-icon-elite">üìù</span>
                                Financial Blog
                            </a></li>
                            <li><a href="about.html" class="footer-link-elite">
                                <span class="footer-link-icon-elite">‚ÑπÔ∏è</span>
                                About Us
                            </a></li>
                            <li><a href="contact.html" class="footer-link-elite">
                                <span class="footer-link-icon-elite">üìû</span>
                                Contact Support
                            </a></li>
                            <li><a href="feedback.html" class="footer-link-elite">
                                <span class="footer-link-icon-elite">üí¨</span>
                                Send Feedback
                            </a></li>
                            <li><a href="#" class="footer-link-elite">
                                <span class="footer-link-icon-elite">‚ùì</span>
                                Help Center
                            </a></li>
                        </ul>
                    </div>

                    <div class="footer-section-elite">
                        <h3 class="footer-section-title-elite">
                            <span>‚öñÔ∏è</span>
                            Legal
                        </h3>
                        <ul class="footer-links-list-elite">
                            <li><a href="privacy.html" class="footer-link-elite">
                                <span class="footer-link-icon-elite">üîí</span>
                                Privacy Policy
                            </a></li>
                            <li><a href="terms.html" class="footer-link-elite">
                                <span class="footer-link-icon-elite">üìÑ</span>
                                Terms of Service
                            </a></li>
                            <li><a href="#" class="footer-link-elite">
                                <span class="footer-link-icon-elite">üç™</span>
                                Cookie Policy
                            </a></li>
                            <li><a href="#" class="footer-link-elite">
                                <span class="footer-link-icon-elite">üõ°Ô∏è</span>
                                Security
                            </a></li>
                            <li><a href="#" class="footer-link-elite">
                                <span class="footer-link-icon-elite">üìã</span>
                                Disclaimer
                            </a></li>
                        </ul>
                    </div>
                </div>

                <!-- Elite Stats Section -->
                <div class="footer-stats-section">
                    <h3 class="footer-section-title-elite">
                        <span>üìä</span>
                        Platform Statistics
                    </h3>
                    <div class="footer-stats-grid">
                        <div class="stat-item-elite">
                            <div class="stat-number-elite">50K+</div>
                            <div class="stat-label-elite">Active Users</div>
                        </div>
                        <div class="stat-item-elite">
                            <div class="stat-number-elite">1M+</div>
                            <div class="stat-label-elite">Calculations</div>
                        </div>
                        <div class="stat-item-elite">
                            <div class="stat-number-elite">5</div>
                            <div class="stat-label-elite">Calculators</div>
                        </div>
                        <div class="stat-item-elite">
                            <div class="stat-number-elite">99.9%</div>
                            <div class="stat-label-elite">Accuracy</div>
                        </div>
                        <div class="stat-item-elite">
                            <div class="stat-number-elite">24/7</div>
                            <div class="stat-label-elite">Available</div>
                        </div>
                        <div class="stat-item-elite">
                            <div class="stat-number-elite">4.9‚òÖ</div>
                            <div class="stat-label-elite">Rating</div>
                        </div>
                    </div>
                </div>

                <!-- Elite Contact Section -->
                <div class="footer-contact-elite">
                    <h3 class="footer-section-title-elite">
                        <span>üìß</span>
                        Get in Touch
                    </h3>
                    <div class="contact-info-elite">
                        <div class="contact-icon-elite">üìß</div>
                        <a href="mailto:support@pratixfinance.com" class="contact-email-elite">
                            support@pratixfinance.com
                        </a>
                    </div>
                    <p style="color: var(--text-secondary); margin-top: 1rem; text-align: center; font-size: 0.9rem;">
                        Have questions? We're here to help you make better financial decisions.
                    </p>
                </div>

                <!-- Enhanced Copyright -->
                <div class="footer-copyright-elite">
                    <p class="copyright-text-elite">
                        ¬© 2024 <strong>PRATIX FINANCE</strong>. All rights reserved. 
                    </p>
                    <p class="tagline-elite">
                        Empowering Financial Decisions Through Smart Calculations
                    </p>
                </div>
            </div>
        </footer>
    </div>

    <script src="universal-nav.js"></script>
    <script>
        // Enhanced Version Management System
        class VersionManager {
            constructor() {
                this.currentVersion = localStorage.getItem('app_version') || '0.0.0';
                this.lastCheckTime = localStorage.getItem('last_version_check') || '0';
                this.updateCheckInterval = 30000; // Check every 30 seconds
                this.isUpdateAvailable = false;

                this.checkForUpdates();
                this.startPeriodicCheck();
                this.setupServiceWorkerListener();
            }

            setupServiceWorkerListener() {
                if ('serviceWorker' in navigator) {
                    navigator.serviceWorker.addEventListener('message', (event) => {
                        if (event.data && event.data.type === 'UPDATE_AVAILABLE') {
                            this.handleServiceWorkerUpdate();
                        }
                    });
                }
            }

            startPeriodicCheck() {
                // Check for updates periodically when page is visible
                setInterval(() => {
                    if (!document.hidden && this.isHomePage()) {
                        this.checkForUpdates(false);
                    }
                }, this.updateCheckInterval);

                // Check when page becomes visible
                document.addEventListener('visibilitychange', () => {
                    if (!document.hidden && this.isHomePage()) {
                        this.checkForUpdates(false);
                    }
                });
            }

            async checkForUpdates(showInitialCheck = true) {
                try {
                    const now = Date.now();
                    const lastCheck = parseInt(this.lastCheckTime);

                    // Don't check too frequently (minimum 10 seconds between checks)
                    if (now - lastCheck < 10000 && !showInitialCheck) {
                        return;
                    }

                    const response = await fetch('./version.json?t=' + now);
                    if (!response.ok) {
                        console.warn('Could not fetch version info');
                        return;
                    }

                    const versionData = await response.json();
                    const serverVersion = versionData.version;

                    localStorage.setItem('last_version_check', now.toString());

                    if (this.isNewerVersion(serverVersion, this.currentVersion)) {
                        if (!this.isUpdateAvailable) {
                            this.isUpdateAvailable = true;
                            this.showUpdateNotification(versionData);
                        }
                    }
                } catch (error) {
                    console.warn('Version check failed:', error);
                }
            }

            handleServiceWorkerUpdate() {
                // Service worker detected an update
                this.isUpdateAvailable = true;
                this.showUpdateNotification({
                    version: 'Latest',
                    updateMessage: 'App has been updated! Please refresh to get the latest version.'
                });
            }

            isHomePage() {
                const path = window.location.pathname;
                return path === '/' || path === '/index.html' || path.endsWith('/index.html') || path === '';
            }

            isNewerVersion(serverVersion, currentVersion) {
                const parseVersion = (version) => {
                    return version.split('.').map(num => parseInt(num, 10));
                };

                const serverParts = parseVersion(serverVersion);
                const currentParts = parseVersion(currentVersion);

                for (let i = 0; i < Math.max(serverParts.length, currentParts.length); i++) {
                    const serverPart = serverParts[i] || 0;
                    const currentPart = currentParts[i] || 0;

                    if (serverPart > currentPart) {
                        return true;
                    } else if (serverPart < currentPart) {
                        return false;
                    }
                }
                return false;
            }

            showUpdateNotification(versionData) {
                const notification = document.getElementById('updateNotification');
                const updateBtn = document.getElementById('updateButton');
                const dismissBtn = document.getElementById('dismissUpdate');

                if (!notification) return;

                // Prevent showing multiple notifications
                if (notification.classList.contains('show')) {
                    return;
                }

                // Update notification text with version info
                const titleElement = notification.querySelector('.update-title');
                const descElement = notification.querySelector('.update-description');

                if (titleElement) {
                    titleElement.textContent = versionData.version !== 'Latest' 
                        ? `New Update Available (v${versionData.version})`
                        : 'App Updated!';
                }

                if (descElement) {
                    descElement.textContent = versionData.updateMessage || 
                        'Click to refresh and get the latest features';
                }

                // Show notification with animation
                notification.style.display = 'flex';
                setTimeout(() => {
                    notification.classList.add('show');
                    this.addNotificationGlow();
                }, 100);

                // Handle update button click
                updateBtn.onclick = () => {
                    this.performUpdate(versionData.version);
                };

                // Handle dismiss button click - don't allow dismissing for 5 seconds
                let canDismiss = false;
                setTimeout(() => {
                    canDismiss = true;
                    dismissBtn.style.opacity = '1';
                    dismissBtn.style.pointerEvents = 'auto';
                }, 5000);

                dismissBtn.onclick = () => {
                    if (canDismiss) {
                        this.dismissNotification();
                    }
                };

                // Make notification more prominent
                this.makeNotificationPersistent();
            }

            addNotificationGlow() {
                const notification = document.getElementById('updateNotification');
                if (notification) {
                    notification.style.animation = 'pulseGlow 2s ease-in-out infinite';
                }
            }

            makeNotificationPersistent() {
                // Add a subtle animation to draw attention
                const notification = document.getElementById('updateNotification');
                if (notification) {
                    // Add a CSS class for persistent styling
                    notification.classList.add('persistent-update');

                    // Shake animation every 30 seconds
                    setInterval(() => {
                        if (notification.classList.contains('show')) {
                            notification.classList.add('shake-notification');
                            setTimeout(() => {
                                notification.classList.remove('shake-notification');
                            }, 500);
                        }
                    }, 30000);
                }
            }

            performUpdate(newVersion) {
                // Show immediate feedback
                const updateBtn = document.getElementById('updateButton');
                const notification = document.getElementById('updateNotification');

                if (updateBtn) {
                    updateBtn.innerHTML = '<span style="animation: spin 1s linear infinite;">üîÑ</span> Updating...';
                    updateBtn.disabled = true;
                    updateBtn.style.background = 'linear-gradient(135deg, #ffa500, #ff6b35)';
                }

                // Update stored version
                if (newVersion !== 'Latest') {
                    localStorage.setItem('app_version', newVersion);
                }

                // Mark that update is in progress
                localStorage.setItem('update_in_progress', 'true');

                // Clear cached data more thoroughly
                this.clearAllCaches().then(() => {
                    // Add a small delay for user feedback
                    setTimeout(() => {
                        // Force a hard reload
                        window.location.reload(true);
                    }, 1500);
                });
            }

            async clearAllCaches() {
                try {
                    // Clear service worker caches
                    if ('caches' in window) {
                        const cacheNames = await caches.keys();
                        await Promise.all(
                            cacheNames.map(cacheName => caches.delete(cacheName))
                        );
                    }

                    // Clear localStorage except essential data
                    const essentialKeys = ['app_version', 'update_in_progress'];
                    const allKeys = Object.keys(localStorage);
                    allKeys.forEach(key => {
                        if (!essentialKeys.includes(key)) {
                            localStorage.removeItem(key);
                        }
                    });

                    // Clear sessionStorage
                    sessionStorage.clear();

                    console.log('All caches cleared successfully');
                } catch (error) {
                    console.warn('Cache clearing failed:', error);
                }
            }

            dismissNotification() {
                const notification = document.getElementById('updateNotification');
                if (notification) {
                    this.isUpdateAvailable = false;
                    notification.classList.remove('show', 'persistent-update');
                    notification.style.animation = '';
                    setTimeout(() => {
                        notification.style.display = 'none';
                    }, 300);
                }
            }

            // Check if update was just completed
            checkUpdateCompletion() {
                const updateInProgress = localStorage.getItem('update_in_progress');
                if (updateInProgress === 'true') {
                    localStorage.removeItem('update_in_progress');
                    this.showUpdateCompletedMessage();
                }
            }

            showUpdateCompletedMessage() {
                // Show a success message that the update was completed
                const successMessage = document.createElement('div');
                successMessage.style.cssText = `
                    position: fixed;
                    top: 20px;
                    left: 50%;
                    transform: translateX(-50%);
                    background: linear-gradient(135deg, #00ff88, #00d4ff);
                    color: white;
                    padding: 1rem 2rem;
                    border-radius: 12px;
                    font-weight: 600;
                    z-index: 10001;
                    box-shadow: 0 8px 32px rgba(0,0,0,0.3);
                    animation: slideInDown 0.5s ease;
                `;
                successMessage.innerHTML = '‚úÖ App updated successfully! You now have the latest version.';

                document.body.appendChild(successMessage);

                setTimeout(() => {
                    successMessage.style.animation = 'slideOutUp 0.5s ease';
                    setTimeout(() => {
                        if (successMessage.parentNode) {
                            successMessage.parentNode.removeChild(successMessage);
                        }
                    }, 500);
                }, 4000);
            }
        }

        // Initialize version manager when DOM is loaded
        document.addEventListener('DOMContentLoaded', () => {
            const versionManager = new VersionManager();
            versionManager.checkUpdateCompletion();
        });

        // Search functionality
        const searchInput = document.getElementById('searchInput');
        const searchResults = document.getElementById('searchResults');
        const calculatorCards = document.querySelectorAll('.calculator-card');

        // Search data
        const searchData = Array.from(calculatorCards).map(card => ({
            element: card,
            name: card.dataset.name,
            keywords: card.dataset.keywords,
            title: card.querySelector('.calculator-title').textContent,
            description: card.querySelector('.calculator-description').textContent
        }));

        searchInput.addEventListener('input', function() {
            const query = this.value.toLowerCase().trim();

            if (query.length === 0) {
                searchResults.style.display = 'none';
                showAllCalculators();
                return;
            }

            // Filter results
            const filtered = searchData.filter(item => 
                item.name.toLowerCase().includes(query) ||
                item.keywords.toLowerCase().includes(query) ||
                item.title.toLowerCase().includes(query) ||
                item.description.toLowerCase().includes(query)
            );

            // Show search results dropdown
            if (filtered.length > 0) {
                searchResults.innerHTML = filtered.map(item => `
                    <div class="search-result-item" data-name="${item.name}">
                        <div class="search-result-title">${item.title}</div>
                        <div class="search-result-description">${item.description}</div>
                    </div>
                `).join('');
                searchResults.style.display = 'block';

                // Add click listeners to search results
                searchResults.querySelectorAll('.search-result-item').forEach(item => {
                    item.addEventListener('click', function() {
                        const cardName = this.dataset.name;
                        const targetCard = Array.from(calculatorCards).find(card => 
                            card.dataset.name === cardName
                        );
                        if (targetCard) {
                            targetCard.scrollIntoView({ behavior: 'smooth', block: 'center' });
                            targetCard.style.transform = 'scale(1.05)';
                            setTimeout(() => {
                                targetCard.style.transform = '';
                            }, 1000);
                        }
                        searchResults.style.display = 'none';
                        searchInput.value = '';
                    });
                });
            } else {
                searchResults.innerHTML = '<div class="search-result-item">No calculators found</div>';
                searchResults.style.display = 'block';
            }

            // Filter visible calculators
            filterCalculators(query);
        });

        // Hide search results when clicking outside
        document.addEventListener('click', function(e) {
            if (!searchInput.contains(e.target) && !searchResults.contains(e.target)) {
                searchResults.style.display = 'none';
            }
        });

        function filterCalculators(query) {
            calculatorCards.forEach(card => {
                const name = card.dataset.name.toLowerCase();
                const keywords = card.dataset.keywords.toLowerCase();
                const title = card.querySelector('.calculator-title').textContent.toLowerCase();
                const description = card.querySelector('.calculator-description').textContent.toLowerCase();

                if (name.includes(query) || keywords.includes(query) || 
                    title.includes(query) || description.includes(query)) {
                    card.style.display = 'block';
                    card.style.animation = 'fadeIn 0.5s ease';
                } else {
                    card.style.display = 'none';
                }
            });
        }

        function showAllCalculators() {
            calculatorCards.forEach(card => {
                card.style.display = 'block';
                card.style.animation = 'fadeIn 0.5s ease';
            });
        }

        // PWA Install Functionality
        let deferredPrompt;
        let isAppInstalled = false;

        // Check if app is already installed
        function checkIfAppInstalled() {
            // Check if running as PWA
            if (window.matchMedia('(display-mode: standalone)').matches || 
                window.navigator.standalone === true) {
                isAppInstalled = true;
                hideDownloadSection();
                return;
            }

            // Check localStorage flag
            const isAppDownloaded = localStorage.getItem('appDownloaded');
            if (isAppDownloaded === 'true') {
                hideDownloadSection();
                return;
            }
        }

        function hideDownloadSection() {
            const downloadSection = document.getElementById('downloadSection');
            if (downloadSection) {
                downloadSection.style.display = 'none';
            }
        }

        function showInstallNotification(message, type = 'success') {
            // Create notification
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                left: 50%;
                transform: translateX(-50%);
                background: ${type === 'success' ? 'linear-gradient(135deg, #00ff88, #00d4ff)' : 'linear-gradient(135deg, #ff4757, #ff6b7a)'};
                color: white;
                padding: 1rem 2rem;
                border-radius: 50px;
                font-weight: 600;
                z-index: 10000;
                box-shadow: 0 8px 32px rgba(0,0,0,0.3);
                backdrop-filter: blur(20px);
                animation: slideInDown 0.3s ease;
            `;
            notification.textContent = message;

            document.body.appendChild(notification);

            setTimeout(() => {
                notification.style.animation = 'slideOutUp 0.3s ease';
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.parentNode.removeChild(notification);
                    }
                }, 300);
            }, 3000);
        }

        // Listen for beforeinstallprompt event
        window.addEventListener('beforeinstallprompt', (e) => {
            console.log('PWA: beforeinstallprompt event fired');

            // Prevent the mini-infobar from appearing on mobile
            e.preventDefault();

            // Save the event so we can trigger it later
            deferredPrompt = e;

            // Show the download button
            const downloadSection = document.getElementById('downloadSection');
            if (downloadSection) {
                downloadSection.style.display = 'block';
            }
        });

        // Listen for app installed event
        window.addEventListener('appinstalled', (e) => {
            console.log('PWA: App installed successfully');

            // Mark as installed
            isAppInstalled = true;
            localStorage.setItem('appDownloaded', 'true');

            // Hide download section
            hideDownloadSection();

            // Show success notification
            showInstallNotification('üéâ App installed successfully! You can now find Pratix Finance on your home screen.');

            // Clear the saved prompt
            deferredPrompt = null;
        });

        // Check install status on page load
        checkIfAppInstalled();

        // Download app button click handlers
        function setupDownloadButtons() {
            const downloadButtons = ['downloadApp', 'downloadAppHero'];

            downloadButtons.forEach(buttonId => {
                const button = document.getElementById(buttonId);
                if (button) {
                    button.addEventListener('click', handleDownload);
                }
            });
        }

        async function handleDownload(e) {
            e.preventDefault();

            if (isAppInstalled) {
                showInstallNotification('App is already installed!', 'info');
                return;
            }

            if (!deferredPrompt) {
                // Fallback for browsers that don't support beforeinstallprompt
                if (navigator.share) {
                    try {
                        await navigator.share({
                            title: 'PRATIX FINANCE - Financial Calculator',
                            text: 'Download PRATIX FINANCE for advanced financial calculations',
                            url: window.location.href
                        });
                    } catch (err) {
                        console.log('Share cancelled');
                    }
                } else {
                    // Provide manual installation instructions
                    showInstallNotification('Please use your browser menu to install this app', 'info');
                }
                return;
            }

            // Update button state
            const originalText = this.innerHTML;
            this.style.opacity = '0.7';
            this.style.pointerEvents = 'none';
            this.innerHTML = '<span>‚è≥</span><span>Installing...</span>';

            try {
                // Show the install prompt
                deferredPrompt.prompt();
                const { outcome } = await deferredPrompt.userChoice;
                console.log('PWA: Install prompt result:', outcome);

                if (outcome === 'accepted') {
                    console.log('PWA: User accepted the install prompt');

                    // Update UI
                    this.innerHTML = '<span>‚úÖ</span><span>Installing...</span>';
                    this.style.background = 'linear-gradient(135deg, #00ff88 0%, #00d4ff 100%)';

                    // The appinstalled event will handle the rest
                } else {
                    console.log('PWA: User dismissed the install prompt');

                    // Reset button
                    this.style.opacity = '1';
                    this.style.pointerEvents = 'auto';
                    this.innerHTML = originalText;

                    showInstallNotification('Installation cancelled. You can try again anytime!', 'info');
                }

                // Clear the prompt
                deferredPrompt = null;

            } catch (error) {
                console.error('PWA: Error during install:', error);

                // Reset button
                this.style.opacity = '1';
                this.style.pointerEvents = 'none';
                this.innerHTML = originalText;

                showInstallNotification('Installation failed. Please try again.', 'error');
            }
        }

        // Setup download buttons when DOM is loaded
        document.addEventListener('DOMContentLoaded', setupDownloadButtons);

        // Register service worker
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('./service-worker.js')
                    .then((registration) => {
                        console.log('PWA: Service Worker registered successfully', registration.scope);

                        // Check for updates
                        registration.addEventListener('updatefound', () => {
                            const newWorker = registration.installing;
                            newWorker.addEventListener('statechange', () => {
                                if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                                    showInstallNotification('üîÑ App updated! Refresh to see the latest version.');
                                }
                            });
                        });
                    })
                    .catch((error) => {
                        console.log('PWA: Service Worker registration failed', error);
                    });
            });
        }

        // Smooth scrolling for internal links
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                const href = this.getAttribute('href');
                if (href && href !== '#' && href.length > 1) {
                    e.preventDefault();
                    const target = document.querySelector(href);
                    if (target) {
                        target.scrollIntoView({
                            behavior: 'smooth',
                            block: 'start'
                        });
                    }
                }
            });
        });

        // Add loading states for calculator links
        document.querySelectorAll('.use-btn').forEach(btn => {
            btn.addEventListener('click', function(e) {
                if (!this.href || this.href === '#') {
                    e.preventDefault();
                    this.style.opacity = '0.7';
                    setTimeout(() => {
                        this.style.opacity = '1';
                    }, 1000);
                } else {
                    this.style.opacity = '0.7';
                }
            });
        });

        // Add scroll-triggered animations
        const observerOptions = {
            threshold: 0.1,
            rootMargin: '0px 0px -50px 0px'
        };

        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.style.animation = 'fadeIn 0.8s ease forwards';
                }
            });
        }, observerOptions);

        // Observe all calculator cards and feature items
        document.querySelectorAll('.calculator-card, .feature-item').forEach(el => {
            observer.observe(el);
        });

        console.log('PRATIX FINANCE Homepage loaded successfully!');
    </script>
</body>
</html>